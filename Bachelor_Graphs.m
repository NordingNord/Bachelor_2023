%x = [0.5029296875, 0.4150390625, 0.46875, 0.4443359375, 0.48828125, 0.458984375, 0.478515625, 0.4736328125, 0.4833984375, 0.4638671875, 0.498046875, 0.4541015625, 0.44921875, 0.4931640625, 0.419921875, 0.4296875, 0.4345703125,0.439453125];
%xp = [-13.427734375, -12.20703125, -9.765625, -8.544921875, -7.32421875, -6.103515625, -4.8828125, -3.662109375, -2.44140625, -1.220703125, 0.0, 1.220703125, 2.44140625, 3.662109375, 4.8828125, 6.103515625, 7.32421875, 8.544921875];
%B = sort(x);
%Bp = sort(xp);
%y1 = [0,0,0,0,0,0,0,5,2,1,201,1622,1052,79,1,3,1,0];
%y2 = [0,0,0,0,0,0,0,0,0,0,0,1,0,0,7,67,44,2];
%y3 = [ 0,0,0,0,0,0,0,6,10,23,76,473,1836,462,45,12,4,1];
%y4 = [1,0,0,0,0,1,1,5,12,18,129,964,1533,309,34,8,2,0];
%y5 = [0,1,1,0,0,0,1,4,8,19,107,626,1686,468,37,3,3,0];
%y6 = [0,1,1,1,1,0,1,0,1,7,21,101,839,1626,362,36,10,0];

%%
%figure('Name','Voltage V')
%tiledlayout(3,3)
%nexttile
%bar(B,y1)
%ylabel('Number of readings:')
%xlabel('Voltage [V]:')
%title('5 min, without water, no tube')

%nexttile
%bar(B,y2)
%ylabel('Number of readings:')
%xlabel('Voltage [V]:')
%title('Blow test, without water, no tube')

%nexttile
%bar(B,y3)
%ylabel('Number of readings:')
%xlabel('Voltage [V]:')
%title('5 min, without water, in tube')

%nexttile
%bar(B,y4)
%ylabel('Number of readings:')
%xlabel('Voltage [V]:')
%title('5 min, movement water, in tube')

%nexttile
%bar(B,y5)
%ylabel('Number of readings:')
%xlabel('Voltage [V]:')
%title('5 min, still water, in tube')

%nexttile
%bar(B,y6)
%ylabel('Number of readings:')
%xlabel('Voltage [V]:')
%title('5 min, Moving water, tube sideways on boat')

%%
%figure("Name",'Pressure kPa')
%tiledlayout(3,3)
%nexttile
%bar(Bp,y1)
%ylabel('Number of readings:')
%xlabel('Pressure [kPa]:')
%title('5 min, without water, no tube')

%nexttile
%bar(Bp,y2)
%ylabel('Number of readings:')
%xlabel('Pressure [kPa]:')
%title('Blow test, without water, no tube')

%nexttile
%bar(Bp,y3)
%ylabel('Number of readings:')
%xlabel('Pressure [kPa]:')
%title('5 min, without water, in tube')

%nexttile
%bar(Bp,y4)
%ylabel('Number of readings:')
%xlabel('Pressure [kPa]:')
%title('5 min, movement water, in tube')

%nexttile
%bar(Bp,y5)
%ylabel('Number of readings:')
%xlabel('Pressure [kPa]:')
%title('5 min, still water, in tube')

%nexttile
%bar(Bp,y6)
%ylabel('Number of readings:')
%xlabel('Pressure [kPa]:')
%title('5 min, Moving water, tube sideways on boat')

%%
%x2 = [0.49199218750000007, 0.49414062500000006, 0.49521484375, 0.49091796875000004, 0.49843750000000003, 0.49736328125000007, 0.49628906250000004, 0.49306640625000003, 0.5005859375, 0.49951171875000006, 0.50166015625, 0.48984375, 0.48876953125000006, 0.5027343750000001, 0.5038085937500001, 0.5081054687500001, 0.5048828125, 0.50703125, 0.48447265625, 0.50595703125, 0.5145507812500001, 0.48339843750000006, 0.48769531250000003, 0.48554687500000004, 0.511328125, 0.511328125, 0.5145507812500001, 0.515625, 0.5134765625000001, 0.51669921875, 0.5188476562500001, 0.5177734375, 0.5263671875, 0.5199218750000001, 0.51025390625, 0.51240234375, 0.52314453125, 0.5091796875000001, 0.50703125, 0.49843750000000003, 0.5081054687500001, 0.49199218750000007, 0.49306640625000003, 0.49843750000000003, 0.49414062500000006, 0.49628906250000004, 0.48876953125000006, 0.49521484375, 0.49736328125000007, 0.49951171875000006, 0.49091796875000004, 0.48984375, 0.5038085937500001, 0.50703125, 0.48125000000000007, 0.5048828125, 0.5134765625000001, 0.5005859375, 0.5145507812500001, 0.5027343750000001, 0.48769531250000003, 0.48232421875000003, 0.50166015625, 0.51025390625, 0.48554687500000004, 0.515625, 0.47802734375000006, 0.511328125, 0.50595703125, 0.5177734375, 0.48339843750000006, 0.49521484375, 0.49306640625000003, 0.49951171875000006, 0.49736328125000007, 0.48984375, 0.49091796875000004, 0.49414062500000006, 0.49199218750000007, 0.49843750000000003, 0.49628906250000004, 0.48876953125000006, 0.5005859375, 0.5048828125, 0.48662109375000007, 0.48769531250000003, 0.50166015625, 0.5027343750000001, 0.48447265625, 0.48554687500000004, 0.5091796875000001, 0.50595703125, 0.48232421875000003, 0.49736328125000007, 0.49306640625000003, 0.49091796875000004, 0.49414062500000006, 0.49199218750000007, 0.49521484375, 0.49628906250000004, 0.49951171875000006, 0.48662109375000007, 0.49843750000000003, 0.5005859375, 0.48984375, 0.5081054687500001, 0.48876953125000006, 0.48554687500000004, 0.48769531250000003, 0.50703125, 0.50166015625, 0.5027343750000001, 0.48017578125000004, 0.48447265625, 0.5038085937500001];
%B2 = sort(x2);
%BD2 = unique(B2(:).')
%y1 = [0,0,0,0,1,1,1,0,1,5,29,103,222,452,650,612,422,234,124,43,36,20,10,6,3,1,2,3,0,0,1,0,0,1,0,0,0,0,0,0,0];
%y2 = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,9,9,20,19,35,44,25,18,11,4,5,2,1];
%y3 = [1,0,2,1,1,0,2,0,5,24,89,203,397,606,617,477,246,144,69,33,14,5,11,5,4,4,7,0,0,1,1,0,1,1,2,0,1,0,0,0,0];
%y4 = [0,0,0,1,0,1,1,9,16,67,169,374,645,617,550,286,149,66,43,11,4,1,1,0,2,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0];
%y5 = [0,1,0,0,0,1,3,7,13,56,135,342,515,687,582,342,156,83,36,21,8,1,2,1,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0];

%figure("Name",'Voltage with ref 1.1')
%tiledlayout(3,3)
%nexttile
%bar(BD2,y1)
%ylabel('Number of readings:')
%xlabel('Voltage [V]:')
%title('5 min, without water, no tube')

%nexttile
%bar(BD2,y2)
%ylabel('Number of readings:')
%xlabel('Voltage [V]:')
%title('Blow test, without water, no tube')

%nexttile
%bar(BD2,y3)
%ylabel('Number of readings:')
%xlabel('Voltage [V]:')
%title('5 min, without water, in tube')

%nexttile
%bar(BD2,y4)
%ylabel('Number of readings:')
%xlabel('Voltage [V]:')
%title('5 min, movement water, in tube')

%nexttile
%bar(BD2,y5)
%ylabel('Number of readings:')
%xlabel('Voltage [V]:')
%title('5 min, still water, in tube')

%% Sensor Pressure test
%clear all
% Import test results
%Data = importdata('Data.txt');
% Remove earlier tests
%Data(1:307,:) = [];

% Extract important data
%Data_10cm = Data(3:39,:);
%Data_15cm = Data(42:75,:);
%Data_20cm = Data(78:112,:);
%Data_25cm = Data(115:150,:);
%Data_30cm = Data(153:189,:);

% Extract pressures


% Different pressure readings
% P_Manual = [0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 8.862304687500004, 9.130859375000009, 9.399414062500014, 9.667968749999991, 9.936523437499996, 10.205078125000004, 10.473632812500009, 11.010742187499991, 11.279296874999996, 11.816406250000009, 12.353515624999991];
% P_Manual2 = [-1.6113281250000056, -0.8056640625000028, -0.5371093749999972, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 8.862304687500004, 9.130859375000009, 9.399414062500014, 9.667968749999991, 9.936523437499996, 10.205078125000004, 10.473632812500009, 12.084960937500014];
% 
% % 10 cm readings
% S1_10cm = [0, 0, 1, 1, 1, 1, 4, 1, 1, 5, 9, 15, 57, 111, 366, 749, 1145, 1102, 786, 296, 153, 72, 42, 28, 13, 7, 8, 4, 2, 2, 2, 3, 3, 2, 1, 4, 1, 2, 0, 0, 0, 0];
% S2_10cm = [0, 0, 1, 0, 1, 0, 2, 0, 2, 10, 17, 27, 126, 285, 693, 1098, 1141, 798, 415, 165, 78, 49, 31, 21, 9, 8, 4, 6, 3, 3, 0, 1, 2, 0, 1, 2, 1, 0, 0, 0, 0, 0];
% S3_10cm = [0,0,2,2,1,0,1,2,3,4,6,16,36,123,287,684,1032,1008,870,452,220,100,55,34,21,9,5,6,4,5,2,1,1,2,4,1,0,0,1,0,0,0];
% 
% S4_10cm = [0,0,0,0,0,0,0, 0, 0, 0, 1, 1, 2, 6, 13, 32, 57, 224, 538, 926, 1239, 921, 501, 225, 124, 68, 36, 14, 11, 15, 11, 6, 4, 5, 4, 1, 2, 3, 5, 2, 1, 1, 0,1,0];
% S5_10cm = [0,0,0,0,0,0,0,2, 1, 1, 4, 6, 9, 11, 27, 64, 215, 480, 908, 1165, 1002, 565, 246, 116, 60, 29, 20, 11, 15, 9, 7, 6, 9, 3, 3, 1, 3, 1, 1, 0, 0, 0,0 0,0];
% 
% % 15 cm readings
% S1_15cm = [0,0,0,0,0,0,3,1,4,2,7,14,25,84,244,533,890,1017,940,496,321,194,99,37,29,18,15,5,5,5,3,3,1,3,1,0,1,0,0,0,0,0];
% S2_15cm = [0,0,0,1,0,1,3,0,3,5,6,15,36,89,262,533,913,985,933,532,314,131,79,53,18,20,21,6,12,9,3,6,2,3,3,1,1,1,0,0,0,0];
% S3_15cm = [0,0,0,1,0,1,1,1,1,2,2,11,19,41,169,441,820,1041,1010,644,377,167,94,48,35,28,8,6,8,6,2,2,1,2,5,1,4,1,0,0,0,0];
% 
% S4_15cm = [0,0,0,0,0,0, 1,0, 3, 2, 2, 3, 6, 6, 16, 53, 112, 362, 740, 1042, 1154, 734, 379, 165, 102, 30, 22, 24, 6, 12, 5, 6, 3, 2, 3,0, 2, 0, 1, 2,0,0,0,0,0];
% S5_15cm = [0,0,0,0,0,2, 1,0, 1, 0, 2, 5, 14, 17, 67, 183, 473, 877, 1128, 1021, 615, 258, 150, 64, 37, 18, 15, 11, 13, 6, 10, 4, 2, 3, 1,0, 1, 1, 0, 0,0,0,0,0,0];
% 
% % 20 cm readings
% S1_20cm = [0,0,0,0,1,1,3,4,4,6,9,26,68,224,592,957,1133,886,549,263,107,62,39,23,15,15,6,1,1,2,1,0,0,1,0,1,0,0,0,0,0,0];
% S2_20cm = [0,0,0,0,0,0,2,3,1,1,2,5,5,10,41,88,260,559,1119,1077,784,437,238,125,69,44,29,17,13,14,18,11,11,5,4,3,3,1,0,1,0,0];
% S3_20cm = [0,0,0,0,1,2,3,1,1,4,6,11,22,67,176,521,935,1118,993,516,277,126,81,39,23,22,16,8,7,2,7,2,5,2,2,2,2,0,0,0,0,0];
% 
% S4_20cm = [0,0, 0, 1, 1, 2, 3, 1, 1, 2, 1, 3, 10, 17, 38, 105, 316, 699, 1031, 1127, 779, 389, 205, 78, 79, 26, 16, 12, 13, 7, 9, 6, 8,0, 3, 3, 1, 2, 1, 2, 2,0, 1,0,0];
% S5_20cm = [0,1, 5, 0, 1, 0, 0, 1, 0, 1, 5, 4, 24, 51, 152, 442, 888, 1221, 1007, 588, 294, 130, 56, 36, 19, 18, 9, 6, 7, 8, 2, 6, 5,0, 3, 2, 3, 2, 2, 1, 0,0, 0,0,0];
% 
% % 25 cm readings
% S1_25cm = [0,0,1,0,2,4,2,4,1,5,14,40,124,321,699,1076,1152,741,438,163,92,44,27,17,10,7,6,5,2,1,0,1,1,0,0,0,0,0,0,0,0,0];
% S2_25cm = [0,0,0,1,0,2,1,1,3,6,10,12,28,92,274,566,775,916,881,605,381,190,104,49,39,23,12,6,10,4,0,1,2,1,1,2,0,0,0,0,1,1];
% S3_25cm = [1,0,0,0,3,2,2,5,3,13,9,44,106,291,660,975,1060,845,506,208,122,52,28,22,12,10,3,9,3,3,0,1,1,0,0,1,0,0,0,0,0,0];
% 
% % 30 cm readings
% S1_30cm = [0,0,2,0,1,2,1,2,5,6,19,45,135,345,742,1034,1061,724,445,180,95,53,32,15,14,12,9,7,4,3,3,1,0,0,2,0,1,0,0,0,0,0];
% S2_30cm = [0,0,1,3,2,3,5,1,6,7,8,32,80,211,540,954,1151,892,561,249,99,58,36,25,20,12,14,6,6,7,2,3,1,1,2,0,1,1,0,0,0,0];
% S3_30cm = [0,2,2,0,0,0,4,5,10,11,21,70,221,527,1050,1169,872,532,238,100,62,27,17,16,12,7,5,5,2,5,0,3,0,1,3,1,0,0,0,0,0,0];
% 
% % Define depht array
% Depht = [10, 15, 20, 25, 30];
% Dummy = zeros(1,42);
% Dummy2 = zeros(1,45);
% 
% S1_Data = [S1_10cm(:), S1_15cm(:), S1_20cm(:), S1_25cm(:), S1_30cm(:)];
% S2_Data = [S2_10cm(:), S2_15cm(:), S2_20cm(:), S2_25cm(:), S2_30cm(:)];
% S3_Data = [S3_10cm(:), S3_15cm(:), S3_20cm(:), S3_25cm(:), S3_30cm(:)];
% S4_Data = [S4_10cm(:), S4_15cm(:), S4_20cm(:)];
% S5_Data = [S5_10cm(:), S5_15cm(:), S5_20cm(:)];
% 
% S1_Data_Dum = [S1_10cm(:), Dummy(:), S1_15cm(:), Dummy(:), S1_20cm(:), Dummy(:), S1_25cm(:), Dummy(:), S1_30cm(:)];
% S2_Data_Dum = [S2_10cm(:), Dummy(:), S2_15cm(:), Dummy(:), S2_20cm(:), Dummy(:), S2_25cm(:), Dummy(:), S2_30cm(:)];
% S3_Data_Dum = [S3_10cm(:), Dummy(:), S3_15cm(:), Dummy(:), S3_20cm(:), Dummy(:), S3_25cm(:), Dummy(:), S3_30cm(:)];
% S4_Data_Dum = [S4_10cm(:), Dummy2(:), S4_15cm(:), Dummy2(:), S4_20cm(:)];
% S5_Data_Dum = [S5_10cm(:), Dummy2(:), S5_15cm(:), Dummy2(:), S5_20cm(:)];
% 
% % ---Plots---
% figure("Name",'Pressure with ref 1.1V 2D');
% Tiles = tiledlayout(5,1,'TileSpacing','Compact','Padding','Compact');
% 
% % S1 plots
% nexttile;
% S1_Bar = bar(P_Manual,S1_Data, 'stacked');
% % Set colour
% set(S1_Bar(1), 'FaceColor',[0.6 0.8 0.9]);
% set(S1_Bar(2), 'FaceColor',[0.4 0.6 0.9]);
% set(S1_Bar(3), 'FaceColor',[0 0 0.7]);
% set(S1_Bar(4), 'FaceColor',[0.1 0.4 0.6]);
% set(S1_Bar(5), 'FaceColor',[0.5 0.55 0.7]);
% legend('Depht: 10cm','Depht: 15cm','Depht: 20cm','Depht: 25cm','Depht: 30cm');
% ylabel('Number of readings:');
% xlabel('Pressure [Kpa]:');
% title('5000 samples: Sensor 1 in 2D');
% 
% % S2 plots
% nexttile;
% S2_Bar = bar(P_Manual,S2_Data, 'stacked');
% % Set colour
% set(S2_Bar(1), 'FaceColor',[0.6 0.8 0.9]);
% set(S2_Bar(2), 'FaceColor',[0.4 0.6 0.9]);
% set(S2_Bar(3), 'FaceColor',[0 0 0.7]);
% set(S2_Bar(4), 'FaceColor',[0.1 0.4 0.6]);
% set(S2_Bar(5), 'FaceColor',[0.5 0.55 0.7]);
% legend('Depht: 10cm','Depht: 15cm','Depht: 20cm','Depht: 25cm','Depht: 30cm');
% ylabel('Number of readings:');
% xlabel('Pressure [Kpa]:');
% title('5000 samples: Sensor 2 in 2D');
% 
% % S3 plots
% nexttile;
% S3_Bar = bar(P_Manual,S3_Data, 'stacked');
% % Set colour
% set(S3_Bar(1), 'FaceColor',[0.6 0.8 0.9]);
% set(S3_Bar(2), 'FaceColor',[0.4 0.6 0.9]);
% set(S3_Bar(3), 'FaceColor',[0 0 0.7]);
% set(S3_Bar(4), 'FaceColor',[0.1 0.4 0.6]);
% set(S3_Bar(5), 'FaceColor',[0.5 0.55 0.7]);
% legend('Depht: 10cm','Depht: 15cm','Depht: 20cm','Depht: 25cm','Depht: 30cm');
% ylabel('Number of readings:');
% xlabel('Pressure [Kpa]:');
% title('5000 samples: Sensor 3 in 2D');
% 
% % S4 plots
% nexttile;
% S4_Bar = bar(P_Manual2,S4_Data, 'stacked');
% % Set colour
% set(S4_Bar(1), 'FaceColor',[0.6 0.8 0.9]);
% set(S4_Bar(2), 'FaceColor',[0.4 0.6 0.9]);
% set(S4_Bar(3), 'FaceColor',[0 0 0.7]);
% %set(S4_Bar(4), 'FaceColor',[0.1 0.4 0.6]);
% %set(S4_Bar(5), 'FaceColor',[0.5 0.55 0.7]);
% legend('Depht: 10cm','Depht: 15cm','Depht: 20cm')%,'Depht: 25cm','Depht: 30cm');
% ylabel('Number of readings:');
% xlabel('Pressure [Kpa]:');
% title('5000 samples: Sensor 4 in 2D');
% 
% % S5 plots
% nexttile;
% S5_Bar = bar(P_Manual2,S5_Data, 'stacked');
% % Set colour
% set(S5_Bar(1), 'FaceColor',[0.6 0.8 0.9]);
% set(S5_Bar(2), 'FaceColor',[0.4 0.6 0.9]);
% set(S5_Bar(3), 'FaceColor',[0 0 0.7]);
% %set(S5_Bar(4), 'FaceColor',[0.1 0.4 0.6]);
% %set(S5_Bar(5), 'FaceColor',[0.5 0.55 0.7]);
% legend('Depht: 10cm','Depht: 15cm','Depht: 20cm')%,'Depht: 25cm','Depht: 30cm');
% ylabel('Number of readings:');
% xlabel('Pressure [Kpa]:');
% title('5000 samples: Sensor 5 in 2D');
% 
% t.TileSpacing = 'compact';
% t.Padding = 'compact';
% 
% figure("Name",'Pressure with ref 1.1V 3D');
% Tiles = tiledlayout(1,3,'TileSpacing','Compact','Padding','Compact');
% 
% nexttile;
% S1_Bar3 = bar3(P_Manual,S1_Data_Dum);
% % Set colour
% set(gca,'XTickLabel',[10 15 20 25 30]);
% set(S1_Bar3(1), 'FaceColor',[0.6 0.8 0.9]);
% set(S1_Bar3(2), 'FaceColor',[1 0 0]);
% set(S1_Bar3(3), 'FaceColor',[0.4 0.6 0.9]);
% set(S1_Bar3(4), 'FaceColor',[1 0 0]);
% set(S1_Bar3(5), 'FaceColor',[0 0 0.7]);
% set(S1_Bar3(6), 'FaceColor',[1 0 0]);
% set(S1_Bar3(7), 'FaceColor',[0.1 0.4 0.6]);
% set(S1_Bar3(8), 'FaceColor',[1 0 0]);
% set(S1_Bar3(9), 'FaceColor',[0.5 0.55 0.7]);
% zlabel('Number of readings:');
% ylabel('Pressure [Kpa]:');
% xlabel('Depht [cm]:');
% legend('Depht: 10cm', 'Dummy Data', 'Depht: 15cm', 'Dummy Data', 'Depht: 20cm', 'Dummy Data', 'Depht: 25cm', 'Dummy Data', 'Depht: 30cm');
% title('5000 samples: Sensor 1 in 3D');
% 
% nexttile;
% S2_Bar3 = bar3(P_Manual,S2_Data_Dum);
% % Set colour
% set(gca,'XTickLabel',[10 15 20 25 30]);
% set(S2_Bar3(1), 'FaceColor',[0.6 0.8 0.9]);
% set(S2_Bar3(2), 'FaceColor',[1 0 0]);
% set(S2_Bar3(3), 'FaceColor',[0.4 0.6 0.9]);
% set(S2_Bar3(4), 'FaceColor',[1 0 0]);
% set(S2_Bar3(5), 'FaceColor',[0 0 0.7]);
% set(S2_Bar3(6), 'FaceColor',[1 0 0]);
% set(S2_Bar3(7), 'FaceColor',[0.1 0.4 0.6]);
% set(S2_Bar3(8), 'FaceColor',[1 0 0]);
% set(S2_Bar3(9), 'FaceColor',[0.5 0.55 0.7]);
% zlabel('Number of readings:');
% ylabel('Pressure [Kpa]:');
% xlabel('Depht [cm]:');
% title('5000 samples: Sensor 2 in 3D');
% 
% nexttile;
% S3_Bar3 = bar3(P_Manual,S3_Data_Dum);
% % Set colour
% set(gca,'XTickLabel',[10 15 20 25 30]);
% set(S3_Bar3(1), 'FaceColor',[0.6 0.8 0.9]);
% set(S3_Bar3(2), 'FaceColor',[1 0 0]);
% set(S3_Bar3(3), 'FaceColor',[0.4 0.6 0.9]);
% set(S3_Bar3(4), 'FaceColor',[1 0 0]);
% set(S3_Bar3(5), 'FaceColor',[0 0 0.7]);
% set(S3_Bar3(6), 'FaceColor',[1 0 0]);
% set(S3_Bar3(7), 'FaceColor',[0.1 0.4 0.6]);
% set(S3_Bar3(8), 'FaceColor',[1 0 0]);
% set(S3_Bar3(9), 'FaceColor',[0.5 0.55 0.7]);
% zlabel('Number of readings:');
% ylabel('Pressure [Kpa]:');
% xlabel('Depht [cm]:');
% title('5000 samples: Sensor 3 in 3D');
% 
% 
% figure("Name",'Pressure with ref 1.1V 3D S4 and S5');
% Tiles = tiledlayout(1,2,'TileSpacing','Compact','Padding','Compact');
% 
% nexttile;
% S4_Bar3 = bar3(P_Manual2,S4_Data_Dum);
% % Set colour
% set(gca,'XTickLabel',[10 15 20 25 30]);
% set(S4_Bar3(1), 'FaceColor',[0.6 0.8 0.9]);
% set(S4_Bar3(2), 'FaceColor',[1 0 0]);
% set(S4_Bar3(3), 'FaceColor',[0.4 0.6 0.9]);
% set(S4_Bar3(4), 'FaceColor',[1 0 0]);
% set(S4_Bar3(5), 'FaceColor',[0 0 0.7]);
% %set(S1_Bar3(4), 'FaceColor',[0.1 0.4 0.6]);
% %set(S1_Bar3(5), 'FaceColor',[0.5 0.55 0.7]);
% zlabel('Number of readings:');
% ylabel('Pressure [Kpa]:');
% xlabel('Depht [cm]:');
% legend('Depht: 10cm', 'Dummy Data', 'Depht: 15cm', 'Dummy Data', 'Depht: 20cm')%,'Depht: 25cm','Depht: 30cm');
% title('5000 samples: Sensor 4 in 3D');
% 
% nexttile;
% S5_Bar3 = bar3(P_Manual2,S5_Data_Dum);
% % Set colour
% set(gca,'XTickLabel',[10 15 20 25 30]);
% set(S5_Bar3(1), 'FaceColor',[0.6 0.8 0.9]);
% set(S5_Bar3(2), 'FaceColor',[1 0 0]);
% set(S5_Bar3(3), 'FaceColor',[0.4 0.6 0.9]);
% set(S5_Bar3(4), 'FaceColor',[1 0 0]);
% set(S5_Bar3(5), 'FaceColor',[0 0 0.7]);
% %set(S1_Bar3(4), 'FaceColor',[0.1 0.4 0.6]);
% %set(S1_Bar3(5), 'FaceColor',[0.5 0.55 0.7]);
% zlabel('Number of readings:');
% ylabel('Pressure [Kpa]:');
% xlabel('Depht [cm]:');
% title('5000 samples: Sensor 5 in 3D');

%% ------- Underside Test --------------------------------
clear all 
% Total Pressure data:
P = [0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 9.130859375000009, -0.26855468750000555, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 9.130859375000009, -0.5371093749999972, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 9.130859375000009, -0.26855468750000555, 0.0, 0.26855468750000555, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 8.862304687500004, -0.5371093749999972, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, -0.5371093749999972, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.862304687500004, -1.6113281250000056, -1.0742187499999944, -0.8056640625000028, -0.5371093749999972, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 8.862304687500004, 9.130859375000009, 9.399414062500014, 9.667968749999991, 9.936523437499996, 10.205078125000004, 10.473632812500009, 12.084960937500014, -1.0742187499999944, -0.8056640625000028, -0.5371093749999972, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 8.862304687500004, 9.130859375000009, 9.399414062500014, 9.667968749999991, 11.547851562500004, 11.816406250000009, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 8.862304687500004, 9.399414062500014, 10.742187500000014, 12.084960937500014, 12.622070312499996, -2.4169921874999947, -0.5371093749999972, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 8.862304687500004, 9.130859375000009, 9.399414062500014, 12.890625000000004, 13.427734375000014, -3.2226562499999973, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 9.130859375000009, 9.667968749999991, 9.936523437499996, 10.473632812500009, 11.547851562500004];
P = sort(P);
P = unique(P(:).');

% Different tests pressure data:
P_0cm_123 = [0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991];
P_10cm_123 = [0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 9.130859375000009];
P_15cm_123 = [-0.26855468750000555, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996];
P_20cm_123 = [-0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 9.130859375000009];
P_25cm_123 = [-0.5371093749999972, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 9.130859375000009];
P_30cm_123 = [-0.26855468750000555, 0.0, 0.26855468750000555, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 8.862304687500004];
P_35cm_123 = [-0.5371093749999972, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996];

P_0cm_45 = [0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996];
P_10cm_45 = [-0.5371093749999972, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.862304687500004];
P_15cm_45 = [-1.6113281250000056, -1.0742187499999944, -0.8056640625000028, -0.5371093749999972, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 8.862304687500004, 9.130859375000009, 9.399414062500014, 9.667968749999991, 9.936523437499996, 10.205078125000004, 10.473632812500009, 12.084960937500014];
P_20cm_45 = [-1.0742187499999944, -0.8056640625000028, -0.5371093749999972, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 8.862304687500004, 9.130859375000009, 9.399414062500014, 9.667968749999991, 11.547851562500004, 11.816406250000009];
P_25cm_45 = [-0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 8.862304687500004, 9.399414062500014, 10.742187500000014, 12.084960937500014, 12.622070312499996];
P_30cm_45 = [-2.4169921874999947, -0.5371093749999972, -0.26855468750000555, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 8.325195312499991, 8.593749999999996, 8.862304687500004, 9.130859375000009, 9.399414062500014, 12.890625000000004, 13.427734375000014];
P_35cm_45 = [-3.2226562499999973, 0.0, 0.26855468750000555, 0.5371093749999972, 0.8056640625000028, 1.0742187500000084, 1.3427734375, 1.6113281250000056, 1.8798828124999973, 2.1484375000000027, 2.4169921875000084, 2.685546875, 2.9541015625000053, 3.2226562499999973, 3.4912109375000027, 3.7597656250000084, 4.0283203125, 4.296875000000005, 4.565429687499997, 4.833984375000003, 5.102539062500008, 5.37109375, 5.639648437500005, 5.908203124999997, 6.176757812500003, 6.445312500000008, 6.713867187500014, 6.982421874999992, 7.250976562499997, 7.519531250000003, 7.788085937500008, 8.056640625000014, 9.130859375000009, 9.667968749999991, 9.936523437499996, 10.473632812500009, 11.547851562500004];

% S1 Data:
S1_0cm = [2,2,1,3,0,3,5,1,11,28,103,288,748,1256,1126,749,351,137,78,41,21,13,5,5,6,2,2,3,3,5,1,1];
S1_10cm = [0,0,1,0,0,3,4,10,33,80,232,640,1032,1288,837,472,167,87,48,23,17,8,4,4,5,3,0,1,0,0,0,1,0];
S1_15cm = [1,2,2,2,1,3,4,8,15,55,179,490,1046,1226,981,504,245,103,41,31,22,6,5,5,9,3,1,5,2,2,1,0,0];
S1_20cm = [0,3,2,1,0,0,1,0,2,21,46,162,455,1023,1285,954,553,240,101,52,36,23,11,5,4,5,4,1,4,1,1,1,1,1,1];
S1_25cm = [1,1,1,1,2,3,0,2,3,10,29,64,234,593,1079,1257,850,462,199,90,47,24,17,7,3,6,4,4,4,1,1,1,0,0];
S1_30cm = [1,0,2,2,2,2,3,13,30,75,209,557,1053,1315,850,441,215,93,49,31,15,10,8,9,3,4,2,0,1,3,1,0,0,1];
S1_35cm = [1,1,1,0,2,1,1,0,3,11,36,77,275,583,1056,1194,911,441,195,92,40,34,11,7,7,7,2,1,2,2,2,1,2,1,0];

% S2 Data:
S2_0cm = [0,0,3,3,2,2,5,8,28,86,264,634,1119,1241,807,417,179,84,52,22,12,5,5,5,6,1,1,4,3,1,0,1];
S2_10cm = [0,1,2,1,1,2,0,7,12,38,110,299,810,1191,1115,755,340,147,65,39,23,9,9,4,6,5,1,4,3,0,0,0,1];
S2_15cm = [0,0,1,1,0,1,3,2,8,19,48,181,594,1026,1236,930,522,212,89,51,28,12,9,12,0,1,2,4,3,3,0,1,1];
S2_20cm = [1,0,0,0,0,1,1,1,3,14,20,57,198,535,1007,1258,950,489,219,102,62,36,14,11,2,4,6,2,1,1,1,3,1,0,0];
S2_25cm = [0,0,0,1,4,2,0,0,5,14,19,61,162,471,953,1222,975,571,271,124,54,43,11,12,4,7,4,3,3,1,1,0,2,0];
S2_30cm = [2,1,4,1,3,1,7,15,26,74,239,633,1118,1204,853,422,189,78,48,30,17,8,9,4,5,2,4,0,0,1,2,0,0,0];
S2_35cm = [0,3,1,1,1,0,2,4,8,23,53,178,464,921,1210,979,627,271,115,49,34,16,11,7,3,3,3,2,1,3,3,3,0,0,1];

% S3 Data:
S3_0cm = [0,0,1,2,3,0,1,2,9,30,88,348,833,1171,1124,707,346,165,70,40,15,6,10,6,6,2,4,4,2,3,0,2];
S3_10cm = [1,0,1,1,1,1,1,5,7,26,70,219,540,1120,1260,919,443,176,88,42,35,12,8,6,5,2,3,2,4,1,1,0,0];
S3_15cm = [0,1,2,2,3,1,0,4,8,6,20,66,259,690,1243,1265,772,351,139,78,46,17,7,1,3,6,3,2,2,2,0,0,1];
S3_20cm = [0,0,0,1,3,0,1,2,1,1,8,20,61,184,546,1024,1235,968,482,227,100,53,24,23,7,6,5,6,3,2,3,1,2,1,0];
S3_25cm = [0,0,0,0,1,0,3,1,3,2,8,16,52,166,466,966,1184,995,587,270,115,64,41,21,11,10,3,1,2,4,3,3,1,1];
S3_30cm = [0,1,0,0,1,1,2,2,7,20,58,189,505,992,1252,934,559,231,119,40,31,9,11,9,4,4,5,5,1,0,3,1,1,3];
S3_35cm = [0,0,0,1,2,3,0,2,0,3,6,34,92,240,648,1118,1187,817,425,210,90,51,32,6,2,5,9,4,1,4,3,3,1,1,0];

% S4 Data:
S4_0cm = [0,2,1,1,3,0,4,6,29,97,256,687,1116,1200,812,415,167,75,38,25,13,7,11,8,8,6,5,4,0,1,2,1];
S4_10cm = [1,1,2,4,0,1,1,1,4,4,7,22,76,203,494,955,1148,976,563,275,116,48,25,14,14,7,5,8,5,7,4,3,2,3,1];
S4_15cm = [0,1,1,0,1,1,2,1,2,2,3,2,7,12,45,91,247,659,1064,1119,771,425,197,103,63,45,24,16,12,12,12,9,14,9,9,4,1,3,1,1,1,4,1,1,1,1];
S4_20cm = [2,1,0,1,1,0,3,3,1,4,3,6,15,48,169,387,841,1166,1003,616,306,143,81,45,35,28,23,13,10,12,5,4,5,2,2,2,3,5,2,2,1,1,0];
S4_25cm = [0,1,0,3,3,3,6,9,22,50,144,387,839,1113,1012,679,321,163,83,32,35,20,14,13,11,11,5,4,4,3,3,1,2,0,1,1,1,1];
S4_30cm = [1,1,0,1,1,1,0,3,4,9,8,27,61,184,432,900,1197,972,561,257,147,64,38,25,22,18,14,12,9,5,4,5,3,3,3,2,1,2,1,1,1];
S4_35cm = [1,1,1,2,3,1,2,6,6,20,54,159,439,870,1143,1009,596,311,134,71,36,39,23,14,13,10,8,12,0,7,2,2,1,1,1,1,1];

% S5 Data:
S5_0cm = [1,3,4,2,1,2,5,27,70,245,604,1198,1264,839,382,158,82,36,21,13,12,9,3,6,5,4,0,0,2,1,1,0];
S5_10cm = [0,0,3,1,2,1,0,2,6,9,29,70,239,569,1145,1198,888,419,216,79,52,9,10,12,10,7,8,5,4,1,2,3,0,1,0];
S5_15cm = [1,1,0,1,0,0,1,2,1,2,6,23,32,63,231,551,995,1193,899,479,200,106,50,36,28,20,19,12,9,7,7,5,3,7,3,0,3,2,1,0,1,0,0,0,0,0];
S5_20cm = [0,0,4,0,3,2,2,0,2,5,8,26,75,193,534,964,1204,935,508,218,105,59,33,30,22,12,11,8,9,9,3,3,1,4,4,1,0,0,0,1,1,0,1];
S5_25cm = [1,2,2,0,4,3,9,12,46,132,431,852,1264,1061,591,288,109,60,45,20,21,17,9,7,4,2,1,0,3,2,0,0,1,1,0,0,0,0];
S5_30cm = [0,0,1,2,4,4,1,4,6,7,21,49,172,450,897,1296,1000,504,251,109,62,40,24,19,18,18,13,11,4,3,6,1,0,1,0,0,1,1,0,0,0];
S5_35cm = [0,2,0,1,1,2,2,9,21,50,118,337,742,1275,1069,653,326,162,74,43,29,22,15,20,8,7,2,4,1,3,2,0,0,0,0,0,0];

% Update Data 0cm:
i = 1;
while ~isequal(P(i),P_0cm_123(1))
    S1_0cm = [0, S1_0cm(1:end)];
    S2_0cm = [0, S2_0cm(1:end)];
    S3_0cm = [0, S3_0cm(1:end)];
    i = i+1;
end
P_0cm_123 = [P(1:i-1),P_0cm_123(1:end)];
i = length(P);
while ~isequal(P(i),P_0cm_123(end))
    S1_0cm = [S1_0cm(1:end),0];
    S2_0cm = [S2_0cm(1:end),0];
    S3_0cm = [S3_0cm(1:end),0];
    i = i-1;
end
P_0cm_123 = [P_0cm_123(1:end),P(i+1:end)];
while ~isequal(length(P_0cm_123),length(P))
    for j = 1:length(P_0cm_123)
        if ~isequal(P_0cm_123(j),P(j))
            S1_0cm = [S1_0cm(1:j-1),0,S1_0cm(j:end)];
            S2_0cm = [S2_0cm(1:j-1),0,S2_0cm(j:end)];
            S3_0cm = [S3_0cm(1:j-1),0,S3_0cm(j:end)];
            P_0cm_123 = [P_0cm_123(1:j-1),P(j),P_0cm_123(j:end)];
        end
    end
end

% now also for S4 and S5
i = 1;
while ~isequal(P(i),P_0cm_45(1))
    S4_0cm = [0, S4_0cm(1:end)];
    S5_0cm = [0, S5_0cm(1:end)];
    i = i+1;
end
P_0cm_45 = [P(1:i-1),P_0cm_45(1:end)];
i = length(P);
while ~isequal(P(i),P_0cm_45(end))
    S4_0cm = [S4_0cm(1:end),0];
    S5_0cm = [S5_0cm(1:end),0];
    i = i-1;
end
P_0cm_45 = [P_0cm_45(1:end),P(i+1:end)];
while ~isequal(length(P_0cm_45),length(P))
    for j = 1:length(P_0cm_45)
        if ~isequal(P_0cm_45(j),P(j))
            S4_0cm = [S4_0cm(1:j-1),0,S4_0cm(j:end)];
            S5_0cm = [S5_0cm(1:j-1),0,S5_0cm(j:end)];
            P_0cm_45 = [P_0cm_45(1:j-1),P(j),P_0cm_45(j:end)];
        end
    end
end


% Update Data 10cm:
i = 1;
while ~isequal(P(i),P_10cm_123(1))
    S1_10cm = [0, S1_10cm(1:end)];
    S2_10cm = [0, S2_10cm(1:end)];
    S3_10cm = [0, S3_10cm(1:end)];
    i = i+1;
end
P_10cm_123 = [P(1:i-1),P_10cm_123(1:end)];
i = length(P);
while ~isequal(P(i),P_10cm_123(end))
    S1_10cm = [S1_10cm(1:end),0];
    S2_10cm = [S2_10cm(1:end),0];
    S3_10cm = [S3_10cm(1:end),0];
    i = i-1;
end
P_10cm_123 = [P_10cm_123(1:end),P(i+1:end)];
while ~isequal(length(P_10cm_123),length(P))
    for j = 1:length(P_10cm_123)
        if ~isequal(P_10cm_123(j),P(j))
            S1_10cm = [S1_10cm(1:j-1),0,S1_10cm(j:end)];
            S2_10cm = [S2_10cm(1:j-1),0,S2_10cm(j:end)];
            S3_10cm = [S3_10cm(1:j-1),0,S3_10cm(j:end)];
            P_10cm_123 = [P_10cm_123(1:j-1),P(j),P_10cm_123(j:end)];
            break;
        end
    end
end

% now also for S4 and S5
i = 1;
while ~isequal(P(i),P_10cm_45(1))
    S4_10cm = [0, S4_10cm(1:end)];
    S5_10cm = [0, S5_10cm(1:end)];
    i = i+1;
end
P_10cm_45 = [P(1:i-1),P_10cm_45(1:end)];
i = length(P);
while ~isequal(P(i),P_10cm_45(end))
    S4_10cm = [S4_10cm(1:end),0];
    S5_10cm = [S5_10cm(1:end),0];
    i = i-1;
end
P_10cm_45 = [P_10cm_45(1:end),P(i+1:end)];
while ~isequal(length(P_10cm_45),length(P))
    for j = 1:length(P_10cm_45)
        if ~isequal(P_10cm_45(j),P(j))
            S4_10cm = [S4_10cm(1:j-1),0,S4_10cm(j:end)];
            S5_10cm = [S5_10cm(1:j-1),0,S5_10cm(j:end)];
            P_10cm_45 = [P_10cm_45(1:j-1),P(j),P_10cm_45(j:end)];
        end
    end
end

% Update Data 15cm:
i = 1;
while ~isequal(P(i),P_15cm_123(1))
    S1_15cm = [0, S1_15cm(1:end)];
    S2_15cm = [0, S2_15cm(1:end)];
    S3_15cm = [0, S3_15cm(1:end)];
    i = i+1;
end
P_15cm_123 = [P(1:i-1),P_15cm_123(1:end)];
i = length(P);
while ~isequal(P(i),P_15cm_123(end))
    S1_15cm = [S1_15cm(1:end),0];
    S2_15cm = [S2_15cm(1:end),0];
    S3_15cm = [S3_15cm(1:end),0];
    i = i-1;
end
P_15cm_123 = [P_15cm_123(1:end),P(i+1:end)];
while ~isequal(length(P_15cm_123),length(P))
    for j = 1:length(P_15cm_123)
        if ~isequal(P_15cm_123(j),P(j))
            S1_15cm = [S1_15cm(1:j-1),0,S1_15cm(j:end)];
            S2_15cm = [S2_15cm(1:j-1),0,S2_15cm(j:end)];
            S3_15cm = [S3_15cm(1:j-1),0,S3_15cm(j:end)];
            P_15cm_123 = [P_15cm_123(1:j-1),P(j),P_15cm_123(j:end)];
            break;
        end
    end
end

% now also for S4 and S5
i = 1;
while ~isequal(P(i),P_15cm_45(1))
    S4_15cm = [0, S4_15cm(1:end)];
    S5_15cm = [0, S5_15cm(1:end)];
    i = i+1;
end
P_15cm_45 = [P(1:i-1),P_15cm_45(1:end)];
i = length(P);
while ~isequal(P(i),P_15cm_45(end))
    S4_15cm = [S4_15cm(1:end),0];
    S5_15cm = [S5_15cm(1:end),0];
    i = i-1;
end
P_15cm_45 = [P_15cm_45(1:end),P(i+1:end)];
while ~isequal(length(P_15cm_45),length(P))
    for j = 1:length(P_15cm_45)
        if ~isequal(P_15cm_45(j),P(j))
            S4_15cm = [S4_15cm(1:j-1),0,S4_15cm(j:end)];
            S5_15cm = [S5_15cm(1:j-1),0,S5_15cm(j:end)];
            P_15cm_45 = [P_15cm_45(1:j-1),P(j),P_15cm_45(j:end)];
        end
    end
end

% Update Data 20cm:
i = 1;
while ~isequal(P(i),P_20cm_123(1))
    S1_20cm = [0, S1_20cm(1:end)];
    S2_20cm = [0, S2_20cm(1:end)];
    S3_20cm = [0, S3_20cm(1:end)];
    i = i+1;
end
P_20cm_123 = [P(1:i-1),P_20cm_123(1:end)];
i = length(P);
while ~isequal(P(i),P_20cm_123(end))
    S1_20cm = [S1_20cm(1:end),0];
    S2_20cm = [S2_20cm(1:end),0];
    S3_20cm = [S3_20cm(1:end),0];
    i = i-1;
end
P_20cm_123 = [P_20cm_123(1:end),P(i+1:end)];
while ~isequal(length(P_20cm_123),length(P))
    for j = 1:length(P_20cm_123)
        if ~isequal(P_20cm_123(j),P(j))
            S1_20cm = [S1_20cm(1:j-1),0,S1_20cm(j:end)];
            S2_20cm = [S2_20cm(1:j-1),0,S2_20cm(j:end)];
            S3_20cm = [S3_20cm(1:j-1),0,S3_20cm(j:end)];
            P_20cm_123 = [P_20cm_123(1:j-1),P(j),P_20cm_123(j:end)];
            break;
        end
    end
end
% now also for S4 and S5
i = 1;
while ~isequal(P(i),P_20cm_45(1))
    S4_20cm = [0, S4_20cm(1:end)];
    S5_20cm = [0, S5_20cm(1:end)];
    i = i+1;
end
P_20cm_45 = [P(1:i-1),P_20cm_45(1:end)];
i = length(P);
while ~isequal(P(i),P_20cm_45(end))
    S4_20cm = [S4_20cm(1:end),0];
    S5_20cm = [S5_20cm(1:end),0];
    i = i-1;
end
P_20cm_45 = [P_20cm_45(1:end),P(i+1:end)];
while ~isequal(length(P_20cm_45),length(P))
    for j = 1:length(P_20cm_45)
        if ~isequal(P_20cm_45(j),P(j))
            S4_20cm = [S4_20cm(1:j-1),0,S4_20cm(j:end)];
            S5_20cm = [S5_20cm(1:j-1),0,S5_20cm(j:end)];
            P_20cm_45 = [P_20cm_45(1:j-1),P(j),P_20cm_45(j:end)];
        end
    end
end

% Update Data 25cm:
i = 1;
while ~isequal(P(i),P_25cm_123(1))
    S1_25cm = [0, S1_25cm(1:end)];
    S2_25cm = [0, S2_25cm(1:end)];
    S3_25cm = [0, S3_25cm(1:end)];
    i = i+1;
end
P_25cm_123 = [P(1:i-1),P_25cm_123(1:end)];
i = length(P);
while ~isequal(P(i),P_25cm_123(end))
    S1_25cm = [S1_25cm(1:end),0];
    S2_25cm = [S2_25cm(1:end),0];
    S3_25cm = [S3_25cm(1:end),0];
    i = i-1;
end
P_25cm_123 = [P_25cm_123(1:end),P(i+1:end)];
while ~isequal(length(P_25cm_123),length(P))
    for j = 1:length(P_25cm_123)
        if ~isequal(P_25cm_123(j),P(j))
            S1_25cm = [S1_25cm(1:j-1),0,S1_25cm(j:end)];
            S2_25cm = [S2_25cm(1:j-1),0,S2_25cm(j:end)];
            S3_25cm = [S3_25cm(1:j-1),0,S3_25cm(j:end)];
            P_25cm_123 = [P_25cm_123(1:j-1),P(j),P_25cm_123(j:end)];
            break;
        end
    end
end

% now also for S4 and S5
i = 1;
while ~isequal(P(i),P_25cm_45(1))
    S4_25cm = [0, S4_25cm(1:end)];
    S5_25cm = [0, S5_25cm(1:end)];
    i = i+1;
end
P_25cm_45 = [P(1:i-1),P_25cm_45(1:end)];
i = length(P);
while ~isequal(P(i),P_25cm_45(end))
    S4_25cm = [S4_25cm(1:end),0];
    S5_25cm = [S5_25cm(1:end),0];
    i = i-1;
end
P_25cm_45 = [P_25cm_45(1:end),P(i+1:end)];
while ~isequal(length(P_25cm_45),length(P))
    for j = 1:length(P_25cm_45)
        if ~isequal(P_25cm_45(j),P(j))
            S4_25cm = [S4_25cm(1:j-1),0,S4_25cm(j:end)];
            S5_25cm = [S5_25cm(1:j-1),0,S5_25cm(j:end)];
            P_25cm_45 = [P_25cm_45(1:j-1),P(j),P_25cm_45(j:end)];
        end
    end
end

% Update Data 30cm:
i = 1;
while ~isequal(P(i),P_30cm_123(1))
    S1_30cm = [0, S1_30cm(1:end)];
    S2_30cm = [0, S2_30cm(1:end)];
    S3_30cm = [0, S3_30cm(1:end)];
    i = i+1;
end
P_30cm_123 = [P(1:i-1),P_30cm_123(1:end)];
i = length(P);
while ~isequal(P(i),P_30cm_123(end))
    S1_30cm = [S1_30cm(1:end),0];
    S2_30cm = [S2_30cm(1:end),0];
    S3_30cm = [S3_30cm(1:end),0];
    i = i-1;
end
P_30cm_123 = [P_30cm_123(1:end),P(i+1:end)];
while ~isequal(length(P_30cm_123),length(P))
    for j = 1:length(P_30cm_123)
        if ~isequal(P_30cm_123(j),P(j))
            S1_30cm = [S1_30cm(1:j-1),0,S1_30cm(j:end)];
            S2_30cm = [S2_30cm(1:j-1),0,S2_30cm(j:end)];
            S3_30cm = [S3_30cm(1:j-1),0,S3_30cm(j:end)];
            P_30cm_123 = [P_30cm_123(1:j-1),P(j),P_30cm_123(j:end)];
            break;
        end
    end
end

% now also for S4 and S5
i = 1;
while ~isequal(P(i),P_30cm_45(1))
    S4_30cm = [0, S4_30cm(1:end)];
    S5_30cm = [0, S5_30cm(1:end)];
    i = i+1;
end
P_30cm_45 = [P(1:i-1),P_30cm_45(1:end)];
i = length(P);
while ~isequal(P(i),P_30cm_45(end))
    S4_30cm = [S4_30cm(1:end),0];
    S5_30cm = [S5_30cm(1:end),0];
    i = i-1;
end
P_30cm_45 = [P_30cm_45(1:end),P(i+1:end)];
while ~isequal(length(P_30cm_45),length(P))
    for j = 1:length(P_30cm_45)
        if ~isequal(P_30cm_45(j),P(j))
            S4_30cm = [S4_30cm(1:j-1),0,S4_30cm(j:end)];
            S5_30cm = [S5_30cm(1:j-1),0,S5_30cm(j:end)];
            P_30cm_45 = [P_30cm_45(1:j-1),P(j),P_30cm_45(j:end)];
        end
    end
end

% Update Data 35cm:
i = 1;
while ~isequal(P(i),P_35cm_123(1))
    S1_35cm = [0, S1_35cm(1:end)];
    S2_35cm = [0, S2_35cm(1:end)];
    S3_35cm = [0, S3_35cm(1:end)];
    i = i+1;
end
P_35cm_123 = [P(1:i-1),P_35cm_123(1:end)];
i = length(P);
while ~isequal(P(i),P_35cm_123(end))
    S1_35cm = [S1_35cm(1:end),0];
    S2_35cm = [S2_35cm(1:end),0];
    S3_35cm = [S3_35cm(1:end),0];
    i = i-1;
end
P_35cm_123 = [P_35cm_123(1:end),P(i+1:end)];
while ~isequal(length(P_35cm_123),length(P))
    for j = 1:length(P_35cm_123)
        if ~isequal(P_35cm_123(j),P(j))
            S1_35cm = [S1_35cm(1:j-1),0,S1_35cm(j:end)];
            S2_35cm = [S2_35cm(1:j-1),0,S2_35cm(j:end)];
            S3_35cm = [S3_35cm(1:j-1),0,S3_35cm(j:end)];
            P_35cm_123 = [P_35cm_123(1:j-1),P(j),P_35cm_123(j:end)];
            break;
        end
    end
end

% now also for S4 and S5
i = 1;
while ~isequal(P(i),P_35cm_45(1))
    S4_35cm = [0, S4_35cm(1:end)];
    S5_35cm = [0, S5_35cm(1:end)];
    i = i+1;
end
P_35cm_45 = [P(1:i-1),P_35cm_45(1:end)];
i = length(P);
while ~isequal(P(i),P_35cm_45(end))
    S4_35cm = [S4_35cm(1:end),0];
    S5_35cm = [S5_35cm(1:end),0];
    i = i-1;
end
P_35cm_45 = [P_35cm_45(1:end),P(i+1:end)];
while ~isequal(length(P_35cm_45),length(P))
    for j = 1:length(P_35cm_45)
        if ~isequal(P_35cm_45(j),P(j))
            S4_35cm = [S4_35cm(1:j-1),0,S4_35cm(j:end)];
            S5_35cm = [S5_35cm(1:j-1),0,S5_35cm(j:end)];
            P_35cm_45 = [P_35cm_45(1:j-1),P(j),P_35cm_45(j:end)];
        end
    end
end

% Now i will find the median of each test

% Initialise the vectors i will be working with
Median_Vector_S1_0cm = [];
Median_Vector_S1_10cm = [];
Median_Vector_S1_15cm = [];
Median_Vector_S1_20cm = [];
Median_Vector_S1_25cm = [];
Median_Vector_S1_30cm = [];
Median_Vector_S1_35cm = [];

Median_Vector_S2_0cm = [];
Median_Vector_S2_10cm = [];
Median_Vector_S2_15cm = [];
Median_Vector_S2_20cm = [];
Median_Vector_S2_25cm = [];
Median_Vector_S2_30cm = [];
Median_Vector_S2_35cm = [];

Median_Vector_S3_0cm = [];
Median_Vector_S3_10cm = [];
Median_Vector_S3_15cm = [];
Median_Vector_S3_20cm = [];
Median_Vector_S3_25cm = [];
Median_Vector_S3_30cm = [];
Median_Vector_S3_35cm = [];

Median_Vector_S4_0cm = [];
Median_Vector_S4_10cm = [];
Median_Vector_S4_15cm = [];
Median_Vector_S4_20cm = [];
Median_Vector_S4_25cm = [];
Median_Vector_S4_30cm = [];
Median_Vector_S4_35cm = [];

Median_Vector_S5_0cm = [];
Median_Vector_S5_10cm = [];
Median_Vector_S5_15cm = [];
Median_Vector_S5_20cm = [];
Median_Vector_S5_25cm = [];
Median_Vector_S5_30cm = [];
Median_Vector_S5_35cm = [];

% Go through each pressure reading and add corresponding times met
for i = 1:length(P)
    Median_Vector_S1_0cm = [Median_Vector_S1_0cm(1:end), zeros(1,S1_0cm(i))+P(i)];
    Median_Vector_S1_10cm = [Median_Vector_S1_10cm(1:end), zeros(1,S1_10cm(i))+P(i)];
    Median_Vector_S1_15cm = [Median_Vector_S1_15cm(1:end), zeros(1,S1_15cm(i))+P(i)];
    Median_Vector_S1_20cm = [Median_Vector_S1_20cm(1:end), zeros(1,S1_20cm(i))+P(i)];
    Median_Vector_S1_25cm = [Median_Vector_S1_25cm(1:end), zeros(1,S1_25cm(i))+P(i)];
    Median_Vector_S1_30cm = [Median_Vector_S1_30cm(1:end), zeros(1,S1_30cm(i))+P(i)];
    Median_Vector_S1_35cm = [Median_Vector_S1_35cm(1:end), zeros(1,S1_35cm(i))+P(i)];

    Median_Vector_S2_0cm = [Median_Vector_S2_0cm(1:end), zeros(1,S2_0cm(i))+P(i)];
    Median_Vector_S2_10cm = [Median_Vector_S2_10cm(1:end), zeros(1,S2_10cm(i))+P(i)];
    Median_Vector_S2_15cm = [Median_Vector_S2_15cm(1:end), zeros(1,S2_15cm(i))+P(i)];
    Median_Vector_S2_20cm = [Median_Vector_S2_20cm(1:end), zeros(1,S2_20cm(i))+P(i)];
    Median_Vector_S2_25cm = [Median_Vector_S2_25cm(1:end), zeros(1,S2_25cm(i))+P(i)];
    Median_Vector_S2_30cm = [Median_Vector_S2_30cm(1:end), zeros(1,S2_30cm(i))+P(i)];
    Median_Vector_S2_35cm = [Median_Vector_S2_35cm(1:end), zeros(1,S2_35cm(i))+P(i)];

    Median_Vector_S3_0cm = [Median_Vector_S3_0cm(1:end), zeros(1,S3_0cm(i))+P(i)];
    Median_Vector_S3_10cm = [Median_Vector_S3_10cm(1:end), zeros(1,S3_10cm(i))+P(i)];
    Median_Vector_S3_15cm = [Median_Vector_S3_15cm(1:end), zeros(1,S3_15cm(i))+P(i)];
    Median_Vector_S3_20cm = [Median_Vector_S3_20cm(1:end), zeros(1,S3_20cm(i))+P(i)];
    Median_Vector_S3_25cm = [Median_Vector_S3_25cm(1:end), zeros(1,S3_25cm(i))+P(i)];
    Median_Vector_S3_30cm = [Median_Vector_S3_30cm(1:end), zeros(1,S3_30cm(i))+P(i)];
    Median_Vector_S3_35cm = [Median_Vector_S3_35cm(1:end), zeros(1,S3_35cm(i))+P(i)];

    Median_Vector_S4_0cm = [Median_Vector_S4_0cm(1:end), zeros(1,S4_0cm(i))+P(i)];
    Median_Vector_S4_10cm = [Median_Vector_S4_10cm(1:end), zeros(1,S4_10cm(i))+P(i)];
    Median_Vector_S4_15cm = [Median_Vector_S4_15cm(1:end), zeros(1,S4_15cm(i))+P(i)];
    Median_Vector_S4_20cm = [Median_Vector_S4_20cm(1:end), zeros(1,S4_20cm(i))+P(i)];
    Median_Vector_S4_25cm = [Median_Vector_S4_25cm(1:end), zeros(1,S4_25cm(i))+P(i)];
    Median_Vector_S4_30cm = [Median_Vector_S4_30cm(1:end), zeros(1,S4_30cm(i))+P(i)];
    Median_Vector_S4_35cm = [Median_Vector_S4_35cm(1:end), zeros(1,S4_35cm(i))+P(i)];
    
    Median_Vector_S5_0cm = [Median_Vector_S5_0cm(1:end), zeros(1,S5_0cm(i))+P(i)];
    Median_Vector_S5_10cm = [Median_Vector_S5_10cm(1:end), zeros(1,S5_10cm(i))+P(i)];
    Median_Vector_S5_15cm = [Median_Vector_S5_15cm(1:end), zeros(1,S5_15cm(i))+P(i)];
    Median_Vector_S5_20cm = [Median_Vector_S5_20cm(1:end), zeros(1,S5_20cm(i))+P(i)];
    Median_Vector_S5_25cm = [Median_Vector_S5_25cm(1:end), zeros(1,S5_25cm(i))+P(i)];
    Median_Vector_S5_30cm = [Median_Vector_S5_30cm(1:end), zeros(1,S5_30cm(i))+P(i)];
    Median_Vector_S5_35cm = [Median_Vector_S5_35cm(1:end), zeros(1,S5_35cm(i))+P(i)];
end

Median_S1_0cm = median(Median_Vector_S1_0cm);
Median_S1_10cm = median(Median_Vector_S1_10cm);
Median_S1_15cm = median(Median_Vector_S1_15cm);
Median_S1_20cm = median(Median_Vector_S1_20cm);
Median_S1_25cm = median(Median_Vector_S1_25cm);
Median_S1_30cm = median(Median_Vector_S1_30cm);
Median_S1_35cm = median(Median_Vector_S1_35cm);

Median_S2_0cm = median(Median_Vector_S2_0cm);
Median_S2_10cm = median(Median_Vector_S2_10cm);
Median_S2_15cm = median(Median_Vector_S2_15cm);
Median_S2_20cm = median(Median_Vector_S2_20cm);
Median_S2_25cm = median(Median_Vector_S2_25cm);
Median_S2_30cm = median(Median_Vector_S2_30cm);
Median_S2_35cm = median(Median_Vector_S2_35cm);

Median_S3_0cm = median(Median_Vector_S3_0cm);
Median_S3_10cm = median(Median_Vector_S3_10cm);
Median_S3_15cm = median(Median_Vector_S3_15cm);
Median_S3_20cm = median(Median_Vector_S3_20cm);
Median_S3_25cm = median(Median_Vector_S3_25cm);
Median_S3_30cm = median(Median_Vector_S3_30cm);
Median_S3_35cm = median(Median_Vector_S3_35cm);

Median_S4_0cm = median(Median_Vector_S4_0cm);
Median_S4_10cm = median(Median_Vector_S4_10cm);
Median_S4_15cm = median(Median_Vector_S4_15cm);
Median_S4_20cm = median(Median_Vector_S4_20cm);
Median_S4_25cm = median(Median_Vector_S4_25cm);
Median_S4_30cm = median(Median_Vector_S4_30cm);
Median_S4_35cm = median(Median_Vector_S4_35cm);

Median_S5_0cm = median(Median_Vector_S5_0cm);
Median_S5_10cm = median(Median_Vector_S5_10cm);
Median_S5_15cm = median(Median_Vector_S5_15cm);
Median_S5_20cm = median(Median_Vector_S5_20cm);
Median_S5_25cm = median(Median_Vector_S5_25cm);
Median_S5_30cm = median(Median_Vector_S5_30cm);
Median_S5_35cm = median(Median_Vector_S5_35cm);

% Now i will find the standart deviation of each test
STD_S1_0cm = std(Median_Vector_S1_0cm);
STD_S1_10cm = std(Median_Vector_S1_10cm);
STD_S1_15cm = std(Median_Vector_S1_15cm);
STD_S1_20cm = std(Median_Vector_S1_20cm);
STD_S1_25cm = std(Median_Vector_S1_25cm);
STD_S1_30cm = std(Median_Vector_S1_30cm);
STD_S1_35cm = std(Median_Vector_S1_35cm);

STD_S2_0cm = std(Median_Vector_S2_0cm);
STD_S2_10cm = std(Median_Vector_S2_10cm);
STD_S2_15cm = std(Median_Vector_S2_15cm);
STD_S2_20cm = std(Median_Vector_S2_20cm);
STD_S2_25cm = std(Median_Vector_S2_25cm);
STD_S2_30cm = std(Median_Vector_S2_30cm);
STD_S2_35cm = std(Median_Vector_S2_35cm);

STD_S3_0cm = std(Median_Vector_S3_0cm);
STD_S3_10cm = std(Median_Vector_S3_10cm);
STD_S3_15cm = std(Median_Vector_S3_15cm);
STD_S3_20cm = std(Median_Vector_S3_20cm);
STD_S3_25cm = std(Median_Vector_S3_25cm);
STD_S3_30cm = std(Median_Vector_S3_30cm);
STD_S3_35cm = std(Median_Vector_S3_35cm);

STD_S4_0cm = std(Median_Vector_S4_0cm);
STD_S4_10cm = std(Median_Vector_S4_10cm);
STD_S4_15cm = std(Median_Vector_S4_15cm);
STD_S4_20cm = std(Median_Vector_S4_20cm);
STD_S4_25cm = std(Median_Vector_S4_25cm);
STD_S4_30cm = std(Median_Vector_S4_30cm);
STD_S4_35cm = std(Median_Vector_S4_35cm);

STD_S5_0cm = std(Median_Vector_S5_0cm);
STD_S5_10cm = std(Median_Vector_S5_10cm);
STD_S5_15cm = std(Median_Vector_S5_15cm);
STD_S5_20cm = std(Median_Vector_S5_20cm);
STD_S5_25cm = std(Median_Vector_S5_25cm);
STD_S5_30cm = std(Median_Vector_S5_30cm);
STD_S5_35cm = std(Median_Vector_S5_35cm);

% 2D plots of pressure
% Define depth
Depth = [0,10, 15, 20, 25, 30, 35];

% Combine all data for each sensor
S1_Data = [S1_0cm(:), S1_10cm(:), S1_15cm(:), S1_20cm(:), S1_25cm(:), S1_30cm(:), S1_35cm(:)];
S2_Data = [S2_0cm(:), S2_10cm(:), S2_15cm(:), S2_20cm(:), S2_25cm(:), S2_30cm(:), S2_35cm(:)];
S3_Data = [S3_0cm(:), S3_10cm(:), S3_15cm(:), S3_20cm(:), S3_25cm(:), S3_30cm(:), S3_35cm(:)];
S4_Data = [S4_0cm(:), S4_10cm(:), S4_15cm(:), S4_20cm(:), S4_25cm(:), S4_30cm(:), S4_35cm(:)];
S5_Data = [S5_0cm(:), S5_10cm(:), S5_15cm(:), S5_20cm(:), S5_25cm(:), S5_30cm(:), S5_35cm(:)];

% Create figure
figure("Name",'Pressure with ref 1.1V 2D');
tiledlayout(5,1,'TileSpacing','Compact','Padding','Compact');
% S1 plots
nexttile;
S1_Bar = bar(P,S1_Data, 'stacked');
% Set colour
set(S1_Bar(1), 'FaceColor',[0.6 0.8 0.9]);
set(S1_Bar(2), 'FaceColor',[0.4 0.6 0.9]);
set(S1_Bar(3), 'FaceColor',[0 0 0.7]);
set(S1_Bar(4), 'FaceColor',[0.1 0.4 0.6]);
set(S1_Bar(5), 'FaceColor',[0.5 0.55 0.7]);
set(S1_Bar(6), 'FaceColor',[0.1 0.1 0.4]);
set(S1_Bar(7), 'FaceColor',[0 0.4 0.4]);
legend('Depth: 0cm','Depth: 10cm','Depth: 15cm','Depth: 20cm','Depth: 25cm','Depth: 30cm', 'Depth: 35cm');
ylabel('Number of readings:');
xlabel('Pressure [Kpa]:');
title('5000 samples: Sensor 1 in 2D');

% S2 plots
nexttile;
S2_Bar = bar(P,S2_Data, 'stacked');
% Set colour
set(S2_Bar(1), 'FaceColor',[0.6 0.8 0.9]);
set(S2_Bar(2), 'FaceColor',[0.4 0.6 0.9]);
set(S2_Bar(3), 'FaceColor',[0 0 0.7]);
set(S2_Bar(4), 'FaceColor',[0.1 0.4 0.6]);
set(S2_Bar(5), 'FaceColor',[0.5 0.55 0.7]);
set(S2_Bar(6), 'FaceColor',[0.1 0.1 0.4]);
set(S2_Bar(7), 'FaceColor',[0 0.4 0.4]);
legend('Depth: 0cm','Depth: 10cm','Depth: 15cm','Depth: 20cm','Depth: 25cm','Depth: 30cm', 'Depth: 35cm');
ylabel('Number of readings:');
xlabel('Pressure [Kpa]:');
title('5000 samples: Sensor 2 in 2D');

% S3 plots
nexttile;
S3_Bar = bar(P,S3_Data, 'stacked');
% Set colour
set(S3_Bar(1), 'FaceColor',[0.6 0.8 0.9]);
set(S3_Bar(2), 'FaceColor',[0.4 0.6 0.9]);
set(S3_Bar(3), 'FaceColor',[0 0 0.7]);
set(S3_Bar(4), 'FaceColor',[0.1 0.4 0.6]);
set(S3_Bar(5), 'FaceColor',[0.5 0.55 0.7]);
set(S3_Bar(6), 'FaceColor',[0.1 0.1 0.4]);
set(S3_Bar(7), 'FaceColor',[0 0.4 0.4]);
legend('Depth: 0cm','Depth: 10cm','Depth: 15cm','Depth: 20cm','Depth: 25cm','Depth: 30cm', 'Depth: 35cm');
ylabel('Number of readings:');
xlabel('Pressure [Kpa]:');
title('5000 samples: Sensor 3 in 2D');

% S4 plots
nexttile;
S4_Bar = bar(P,S4_Data, 'stacked');
% Set colour
set(S4_Bar(1), 'FaceColor',[0.6 0.8 0.9]);
set(S4_Bar(2), 'FaceColor',[0.4 0.6 0.9]);
set(S4_Bar(3), 'FaceColor',[0 0 0.7]);
set(S4_Bar(4), 'FaceColor',[0.1 0.4 0.6]);
set(S4_Bar(5), 'FaceColor',[0.5 0.55 0.7]);
set(S4_Bar(6), 'FaceColor',[0.1 0.1 0.4]);
set(S4_Bar(7), 'FaceColor',[0 0.4 0.4]);
legend('Depth: 0cm','Depth: 10cm','Depth: 15cm','Depth: 20cm','Depth: 25cm','Depth: 30cm', 'Depth: 35cm');
ylabel('Number of readings:');
xlabel('Pressure [Kpa]:');
title('5000 samples: Sensor 4 in 2D');

% S5 plots
nexttile;
S5_Bar = bar(P,S5_Data, 'stacked');
% Set colour
set(S5_Bar(1), 'FaceColor',[0.6 0.8 0.9]);
set(S5_Bar(2), 'FaceColor',[0.4 0.6 0.9]);
set(S5_Bar(3), 'FaceColor',[0 0 0.7]);
set(S5_Bar(4), 'FaceColor',[0.1 0.4 0.6]);
set(S5_Bar(5), 'FaceColor',[0.5 0.55 0.7]);
set(S5_Bar(6), 'FaceColor',[0.1 0.1 0.4]);
set(S5_Bar(7), 'FaceColor',[0 0.4 0.4]);
legend('Depth: 0cm','Depth: 10cm','Depth: 15cm','Depth: 20cm','Depth: 25cm','Depth: 30cm', 'Depth: 35cm');
ylabel('Number of readings:');
xlabel('Pressure [Kpa]:');
title('5000 samples: Sensor 5 in 2D');

% Plot Medians
S1_Medians = [Median_S1_0cm, Median_S1_10cm, Median_S1_15cm, Median_S1_20cm, Median_S1_25cm, Median_S1_30cm, Median_S1_35cm];
S2_Medians = [Median_S2_0cm, Median_S2_10cm, Median_S2_15cm, Median_S2_20cm, Median_S2_25cm, Median_S2_30cm, Median_S2_35cm];
S3_Medians = [Median_S3_0cm, Median_S3_10cm, Median_S3_15cm, Median_S3_20cm, Median_S3_25cm, Median_S3_30cm, Median_S3_35cm];
S4_Medians = [Median_S4_0cm, Median_S4_10cm, Median_S4_15cm, Median_S4_20cm, Median_S4_25cm, Median_S4_30cm, Median_S4_35cm];
S5_Medians = [Median_S5_0cm, Median_S5_10cm, Median_S5_15cm, Median_S5_20cm, Median_S5_25cm, Median_S5_30cm, Median_S5_35cm];

% Create figure
figure("Name",'Medians with ref 1.1V');
tiledlayout(5,1,'TileSpacing','Compact','Padding','Compact');
% S1 plot
nexttile;
S1_M_Plot = plot(S1_Medians, Depth,'.', 'markersize',8);
S1_M_Plot.Color = "red";
ylabel('Depth [cm]:');
xlabel('Median Pressure [Kpa]:');
title('5000 samples: Sensor 1 median');
% S2 plot
nexttile;
S2_M_Plot = plot(S2_Medians, Depth,'.', 'markersize',8);
S2_M_Plot.Color = "red";
ylabel('Depth [cm]:');
xlabel('Median Pressure [Kpa]:');
title('5000 samples: Sensor 2 median');
% S3 plots
nexttile;
S3_M_Plot = plot(S3_Medians, Depth,'.', 'markersize',8);
S3_M_Plot.Color = "red";
ylabel('Depth [cm]:');
xlabel('Median Pressure [Kpa]:');
title('5000 samples: Sensor 3 median');
% S4 plots
nexttile;
S4_M_Plot = plot(S4_Medians, Depth,'.', 'markersize',8);
S4_M_Plot.Color = "red";
ylabel('Depth [cm]:');
xlabel('Median Pressure [Kpa]:');
title('5000 samples: Sensor 4 median');
% S5 plots
nexttile;
S5_M_Plot = plot(S5_Medians, Depth,'.', 'markersize',8);
S5_M_Plot.Color = "red";
ylabel('Depth [cm]:');
xlabel('Median Pressure [Kpa]:');
title('5000 samples: Sensor 5 median');

% Plot Standart deviations
S1_STD = [STD_S1_0cm, STD_S1_10cm, STD_S1_15cm, STD_S1_20cm, STD_S1_25cm, STD_S1_30cm, STD_S1_35cm];
S2_STD = [STD_S2_0cm, STD_S2_10cm, STD_S2_15cm, STD_S2_20cm, STD_S2_25cm, STD_S2_30cm, STD_S2_35cm];
S3_STD = [STD_S3_0cm, STD_S3_10cm, STD_S3_15cm, STD_S3_20cm, STD_S3_25cm, STD_S3_30cm, STD_S3_35cm];
S4_STD = [STD_S4_0cm, STD_S4_10cm, STD_S4_15cm, STD_S4_20cm, STD_S4_25cm, STD_S4_30cm, STD_S4_35cm];
S5_STD = [STD_S5_0cm, STD_S5_10cm, STD_S5_15cm, STD_S5_20cm, STD_S5_25cm, STD_S5_30cm, STD_S5_35cm];

% Create figure
figure("Name",'Standart deviation with ref 1.1V');
Tiles = tiledlayout(5,1,'TileSpacing','Compact','Padding','Compact');
% S1 plot
nexttile;
S1_STD_Plot = plot(S1_STD, Depth,'.', 'markersize',8);
S1_STD_Plot.Color = "red";
ylabel('Depth [cm]:');
xlabel('STD [Kpa]:');
title('5000 samples: Sensor 1 STD');
% S2 plot
nexttile;
S2_STD_Plot = plot(S2_STD, Depth,'.', 'markersize',8);
S2_STD_Plot.Color = "red";
ylabel('Depth [cm]:');
xlabel('STD [Kpa]:');
title('5000 samples: Sensor 2 STD');
% S3 plots
nexttile;
S3_STD_Plot = plot(S3_STD, Depth,'.', 'markersize',8);
S3_STD_Plot.Color = "red";
ylabel('Depth [cm]:');
xlabel('STD [Kpa]:');
title('5000 samples: Sensor 3 STD');
% S4 plots
nexttile;
S4_STD_Plot = plot(S4_STD, Depth,'.', 'markersize',8);
S4_STD_Plot.Color = "red";
ylabel('Depth [cm]:');
xlabel('STD [Kpa]:');
title('5000 samples: Sensor 4 STD');
% S5 plots
nexttile;
S5_STD_Plot = plot(S5_STD, Depth,'.', 'markersize',8);
S5_STD_Plot.Color = "red";
ylabel('Depth [cm]:');
xlabel('STD [Kpa]:');
title('5000 samples: Sensor 5 STD');

% Plot where i remove insignificant readings.
% Start by removing insignificant readings
P_Cut = P(17:26);
S1_Data_Cut = [S1_0cm(17:26); S1_10cm(17:26); S1_15cm(17:26); S1_20cm(17:26); S1_25cm(17:26); S1_30cm(17:26); S1_35cm(17:26)];
S2_Data_Cut = [S2_0cm(17:26); S2_10cm(17:26); S2_15cm(17:26); S2_20cm(17:26); S2_25cm(17:26); S2_30cm(17:26); S2_35cm(17:26)];
S3_Data_Cut = [S3_0cm(17:26); S3_10cm(17:26); S3_15cm(17:26); S3_20cm(17:26); S3_25cm(17:26); S3_30cm(17:26); S3_35cm(17:26)];
S4_Data_Cut = [S4_0cm(17:26); S4_10cm(17:26); S4_15cm(17:26); S4_20cm(17:26); S4_25cm(17:26); S4_30cm(17:26); S4_35cm(17:26)];
S5_Data_Cut = [S5_0cm(17:26); S5_10cm(17:26); S5_15cm(17:26); S5_20cm(17:26); S5_25cm(17:26); S5_30cm(17:26); S5_35cm(17:26)];


figure("Name",'Pressure with ref 1.1V 2D');
tiledlayout(5,1,'TileSpacing','Compact','Padding','Compact');
% S1 plots
nexttile;
S1_Bar_Cut = bar(P_Cut,S1_Data_Cut);
% Set colour
set(S1_Bar_Cut(1), 'FaceColor',[0.6 0.8 0.9]);
set(S1_Bar_Cut(2), 'FaceColor',[0.4 0.6 0.9]);
set(S1_Bar_Cut(3), 'FaceColor',[0 0 0.7]);
set(S1_Bar_Cut(4), 'FaceColor',[0.1 0.4 0.6]);
set(S1_Bar_Cut(5), 'FaceColor',[0.5 0.55 0.7]);
set(S1_Bar_Cut(6), 'FaceColor',[0.1 0.1 0.4]);
set(S1_Bar_Cut(7), 'FaceColor',[0 0.4 0.4]);
legend('Depth: 0cm','Depth: 10cm','Depth: 15cm','Depth: 20cm','Depth: 25cm','Depth: 30cm', 'Depth: 35cm');
ylabel('Number of readings:');
xlabel('Pressure [Kpa]:');
title('5000 samples: Sensor 1 in 2D');

% S2 plots
nexttile;
S2_Bar_Cut = bar(P_Cut,S2_Data_Cut);
% Set colour
set(S2_Bar_Cut(1), 'FaceColor',[0.6 0.8 0.9]);
set(S2_Bar_Cut(2), 'FaceColor',[0.4 0.6 0.9]);
set(S2_Bar_Cut(3), 'FaceColor',[0 0 0.7]);
set(S2_Bar_Cut(4), 'FaceColor',[0.1 0.4 0.6]);
set(S2_Bar_Cut(5), 'FaceColor',[0.5 0.55 0.7]);
set(S2_Bar_Cut(6), 'FaceColor',[0.1 0.1 0.4]);
set(S2_Bar_Cut(7), 'FaceColor',[0 0.4 0.4]);
legend('Depth: 0cm','Depth: 10cm','Depth: 15cm','Depth: 20cm','Depth: 25cm','Depth: 30cm', 'Depth: 35cm');
ylabel('Number of readings:');
xlabel('Pressure [Kpa]:');
title('5000 samples: Sensor 2 in 2D');

% S3 plots
nexttile;
S3_Bar_Cut = bar(P_Cut,S3_Data_Cut);
% Set colour
set(S3_Bar_Cut(1), 'FaceColor',[0.6 0.8 0.9]);
set(S3_Bar_Cut(2), 'FaceColor',[0.4 0.6 0.9]);
set(S3_Bar_Cut(3), 'FaceColor',[0 0 0.7]);
set(S3_Bar_Cut(4), 'FaceColor',[0.1 0.4 0.6]);
set(S3_Bar_Cut(5), 'FaceColor',[0.5 0.55 0.7]);
set(S3_Bar_Cut(6), 'FaceColor',[0.1 0.1 0.4]);
set(S3_Bar_Cut(7), 'FaceColor',[0 0.4 0.4]);
legend('Depth: 0cm','Depth: 10cm','Depth: 15cm','Depth: 20cm','Depth: 25cm','Depth: 30cm', 'Depth: 35cm');
ylabel('Number of readings:');
xlabel('Pressure [Kpa]:');
title('5000 samples: Sensor 3 in 2D');

% S4 plots
nexttile;
S4_Bar_Cut = bar(P_Cut,S4_Data_Cut);
% Set colour
set(S4_Bar_Cut(1), 'FaceColor',[0.6 0.8 0.9]);
set(S4_Bar_Cut(2), 'FaceColor',[0.4 0.6 0.9]);
set(S4_Bar_Cut(3), 'FaceColor',[0 0 0.7]);
set(S4_Bar_Cut(4), 'FaceColor',[0.1 0.4 0.6]);
set(S4_Bar_Cut(5), 'FaceColor',[0.5 0.55 0.7]);
set(S4_Bar_Cut(6), 'FaceColor',[0.1 0.1 0.4]);
set(S4_Bar_Cut(7), 'FaceColor',[0 0.4 0.4]);
legend('Depth: 0cm','Depth: 10cm','Depth: 15cm','Depth: 20cm','Depth: 25cm','Depth: 30cm', 'Depth: 35cm');
ylabel('Number of readings:');
xlabel('Pressure [Kpa]:');
title('5000 samples: Sensor 4 in 2D');

% S5 plots
nexttile;
S5_Bar_Cut = bar(P_Cut,S5_Data_Cut);
% Set colour
set(S5_Bar_Cut(1), 'FaceColor',[0.6 0.8 0.9]);
set(S5_Bar_Cut(2), 'FaceColor',[0.4 0.6 0.9]);
set(S5_Bar_Cut(3), 'FaceColor',[0 0 0.7]);
set(S5_Bar_Cut(4), 'FaceColor',[0.1 0.4 0.6]);
set(S5_Bar_Cut(5), 'FaceColor',[0.5 0.55 0.7]);
set(S5_Bar_Cut(6), 'FaceColor',[0.1 0.1 0.4]);
set(S5_Bar_Cut(7), 'FaceColor',[0 0.4 0.4]);
legend('Depth: 0cm','Depth: 10cm','Depth: 15cm','Depth: 20cm','Depth: 25cm','Depth: 30cm', 'Depth: 35cm');
ylabel('Number of readings:');
xlabel('Pressure [Kpa]:');
title('5000 samples: Sensor 5 in 2D');

% 3D plot
figure("Name",'Pressure with ref 1.1V 3D');
tiledlayout(2,3,'TileSpacing','Compact','Padding','Compact');
 
nexttile;
S1_Bar3 = bar3(P,S1_Data);
% Set colour
set(gca,'XTickLabel',[0 10 15 20 25 30 35]);
set(S1_Bar3(1), 'FaceColor',[0.6 0.8 0.9]);
set(S1_Bar3(2), 'FaceColor',[0.4 0.6 0.9]);
set(S1_Bar3(3), 'FaceColor',[0 0 0.7]);
set(S1_Bar3(4), 'FaceColor',[0.1 0.4 0.6]);
set(S1_Bar3(5), 'FaceColor',[0.5 0.55 0.7]);
set(S1_Bar3(6), 'FaceColor',[0.1 0.1 0.4]);
set(S1_Bar3(7), 'FaceColor',[0 0.4 0.4]);
zlabel('Number of readings:');
ylabel('Pressure [Kpa]:');
xlabel('Depth [cm]:');
legend('Depth: 0cm','Depth: 10cm', 'Depth: 15cm', 'Depth: 20cm', 'Depth: 25cm', 'Depth: 30cm', 'Depth: 35cm');
title('5000 samples: Sensor 1 in 3D');

nexttile;
S2_Bar3 = bar3(P,S2_Data);
% Set colour
set(gca,'XTickLabel',[0 10 15 20 25 30 35]);
set(S2_Bar3(1), 'FaceColor',[0.6 0.8 0.9]);
set(S2_Bar3(2), 'FaceColor',[0.4 0.6 0.9]);
set(S2_Bar3(3), 'FaceColor',[0 0 0.7]);
set(S2_Bar3(4), 'FaceColor',[0.1 0.4 0.6]);
set(S2_Bar3(5), 'FaceColor',[0.5 0.55 0.7]);
set(S2_Bar3(6), 'FaceColor',[0.1 0.1 0.4]);
set(S2_Bar3(7), 'FaceColor',[0 0.4 0.4]);
zlabel('Number of readings:');
ylabel('Pressure [Kpa]:');
xlabel('Depth [cm]:');
legend('Depth: 0cm','Depth: 10cm', 'Depth: 15cm', 'Depth: 20cm', 'Depth: 25cm', 'Depth: 30cm', 'Depth: 35cm');
title('5000 samples: Sensor 2 in 3D');

nexttile;
S3_Bar3 = bar3(P,S3_Data);
% Set colour
set(gca,'XTickLabel',[0 10 15 20 25 30 35]);
set(S3_Bar3(1), 'FaceColor',[0.6 0.8 0.9]);
set(S3_Bar3(2), 'FaceColor',[0.4 0.6 0.9]);
set(S3_Bar3(3), 'FaceColor',[0 0 0.7]);
set(S3_Bar3(4), 'FaceColor',[0.1 0.4 0.6]);
set(S3_Bar3(5), 'FaceColor',[0.5 0.55 0.7]);
set(S3_Bar3(6), 'FaceColor',[0.1 0.1 0.4]);
set(S3_Bar3(7), 'FaceColor',[0 0.4 0.4]);
zlabel('Number of readings:');
ylabel('Pressure [Kpa]:');
xlabel('Depth [cm]:');
legend('Depth: 0cm','Depth: 10cm', 'Depth: 15cm', 'Depth: 20cm', 'Depth: 25cm', 'Depth: 30cm', 'Depth: 35cm');
title('5000 samples: Sensor 3 in 3D');

nexttile;
S4_Bar3 = bar3(P,S4_Data);
% Set colour
set(gca,'XTickLabel',[0 10 15 20 25 30 35]);
set(S4_Bar3(1), 'FaceColor',[0.6 0.8 0.9]);
set(S4_Bar3(2), 'FaceColor',[0.4 0.6 0.9]);
set(S4_Bar3(3), 'FaceColor',[0 0 0.7]);
set(S4_Bar3(4), 'FaceColor',[0.1 0.4 0.6]);
set(S4_Bar3(5), 'FaceColor',[0.5 0.55 0.7]);
set(S4_Bar3(6), 'FaceColor',[0.1 0.1 0.4]);
set(S4_Bar3(7), 'FaceColor',[0 0.4 0.4]);
zlabel('Number of readings:');
ylabel('Pressure [Kpa]:');
xlabel('Depth [cm]:');
legend('Depth: 0cm','Depth: 10cm', 'Depth: 15cm', 'Depth: 20cm', 'Depth: 25cm', 'Depth: 30cm', 'Depth: 35cm');
title('5000 samples: Sensor 4 in 3D');

nexttile;
S5_Bar3 = bar3(P,S5_Data);
% Set colour
set(gca,'XTickLabel',[0 10 15 20 25 30 35]);
set(S5_Bar3(1), 'FaceColor',[0.6 0.8 0.9]);
set(S5_Bar3(2), 'FaceColor',[0.4 0.6 0.9]);
set(S5_Bar3(3), 'FaceColor',[0 0 0.7]);
set(S5_Bar3(4), 'FaceColor',[0.1 0.4 0.6]);
set(S5_Bar3(5), 'FaceColor',[0.5 0.55 0.7]);
set(S5_Bar3(6), 'FaceColor',[0.1 0.1 0.4]);
set(S5_Bar3(7), 'FaceColor',[0 0.4 0.4]);
zlabel('Number of readings:');
ylabel('Pressure [Kpa]:');
xlabel('Depth [cm]:');
legend('Depth: 0cm','Depth: 10cm', 'Depth: 15cm', 'Depth: 20cm', 'Depth: 25cm', 'Depth: 30cm', 'Depth: 35cm');
title('5000 samples: Sensor 5 in 3D');

% Boxplot fun
S1_Box_Data = [Median_Vector_S1_0cm.' Median_Vector_S1_10cm.' Median_Vector_S1_15cm.' Median_Vector_S1_20cm.' Median_Vector_S1_25cm.' Median_Vector_S1_30cm.' Median_Vector_S1_35cm.'];
S2_Box_Data = [Median_Vector_S2_0cm.' Median_Vector_S2_10cm.' Median_Vector_S2_15cm.' Median_Vector_S2_20cm.' Median_Vector_S2_25cm.' Median_Vector_S2_30cm.' Median_Vector_S2_35cm.'];
S3_Box_Data = [Median_Vector_S3_0cm.' Median_Vector_S3_10cm.' Median_Vector_S3_15cm.' Median_Vector_S3_20cm.' Median_Vector_S3_25cm.' Median_Vector_S3_30cm.' Median_Vector_S3_35cm.'];
S4_Box_Data = [Median_Vector_S4_0cm.' Median_Vector_S4_10cm.' Median_Vector_S4_15cm.' Median_Vector_S4_20cm.' Median_Vector_S4_25cm.' Median_Vector_S4_30cm.' Median_Vector_S4_35cm.'];
S5_Box_Data = [Median_Vector_S5_0cm.' Median_Vector_S5_10cm.' Median_Vector_S5_15cm.' Median_Vector_S5_20cm.' Median_Vector_S5_25cm.' Median_Vector_S5_30cm.' Median_Vector_S5_35cm.'];


figure("Name",'Pressure with ref 1.1V Boxplot');
tiledlayout(5,1,'TileSpacing','Compact','Padding','Compact');

nexttile
S1_B = boxplot(S1_Box_Data,'Notch','on','Labels',{'0cm','10cm','15cm','20cm','25cm','30cm','35cm'});
title("Pressure by depth S1")
xlabel("Depth [cm]:")
ylabel("Pressure [Kpa]:")

nexttile
S2_B = boxplot(S2_Box_Data,'Notch','on','Labels',{'0cm','10cm','15cm','20cm','25cm','30cm','35cm'});
title("Pressure by depth S2")
xlabel("Depth [cm]:")
ylabel("Pressure [Kpa]:")

nexttile
S3_B = boxplot(S3_Box_Data,'Notch','on','Labels',{'0cm','10cm','15cm','20cm','25cm','30cm','35cm'});
title("Pressure by depth S3")
xlabel("Depth [cm]:")
ylabel("Pressure [Kpa]:")

nexttile
S4_B = boxplot(S4_Box_Data,'Notch','on','Labels',{'0cm','10cm','15cm','20cm','25cm','30cm','35cm'});
title("Pressure by depth S4")
xlabel("Depth [cm]:")
ylabel("Pressure [Kpa]:")

nexttile
S5_B = boxplot(S5_Box_Data,'Notch','on','Labels',{'0cm','10cm','15cm','20cm','25cm','30cm','35cm'});
title("Pressure by depth S5")
xlabel("Depth [cm]:")
ylabel("Pressure [Kpa]:")


% Boxplot smaller
Vec_Cut_S1_0cm = Median_Vector_S1_0cm(100:4900);
Vec_Cut_S1_10cm = Median_Vector_S1_10cm(100:4900);
Vec_Cut_S1_15cm = Median_Vector_S1_15cm(100:4900);
Vec_Cut_S1_20cm = Median_Vector_S1_20cm(100:4900);
Vec_Cut_S1_25cm = Median_Vector_S1_25cm(100:4900);
Vec_Cut_S1_30cm = Median_Vector_S1_30cm(100:4900);
Vec_Cut_S1_35cm = Median_Vector_S1_35cm(100:4900);
Vec_Cut_S2_0cm = Median_Vector_S2_0cm(100:4900);
Vec_Cut_S2_10cm = Median_Vector_S2_10cm(100:4900);
Vec_Cut_S2_15cm = Median_Vector_S2_15cm(100:4900);
Vec_Cut_S2_20cm = Median_Vector_S2_20cm(100:4900);
Vec_Cut_S2_25cm = Median_Vector_S2_25cm(100:4900);
Vec_Cut_S2_30cm = Median_Vector_S2_30cm(100:4900);
Vec_Cut_S2_35cm = Median_Vector_S2_35cm(100:4900);
Vec_Cut_S3_0cm = Median_Vector_S3_0cm(100:4900);
Vec_Cut_S3_10cm = Median_Vector_S3_10cm(100:4900);
Vec_Cut_S3_15cm = Median_Vector_S3_15cm(100:4900);
Vec_Cut_S3_20cm = Median_Vector_S3_20cm(100:4900);
Vec_Cut_S3_25cm = Median_Vector_S3_25cm(100:4900);
Vec_Cut_S3_30cm = Median_Vector_S3_30cm(100:4900);
Vec_Cut_S3_35cm = Median_Vector_S3_35cm(100:4900);
Vec_Cut_S4_0cm = Median_Vector_S4_0cm(100:4900);
Vec_Cut_S4_10cm = Median_Vector_S4_10cm(100:4900);
Vec_Cut_S4_15cm = Median_Vector_S4_15cm(100:4900);
Vec_Cut_S4_20cm = Median_Vector_S4_20cm(100:4900);
Vec_Cut_S4_25cm = Median_Vector_S4_25cm(100:4900);
Vec_Cut_S4_30cm = Median_Vector_S4_30cm(100:4900);
Vec_Cut_S4_35cm = Median_Vector_S4_35cm(100:4900);
Vec_Cut_S5_0cm = Median_Vector_S5_0cm(100:4900);
Vec_Cut_S5_10cm = Median_Vector_S5_10cm(100:4900);
Vec_Cut_S5_15cm = Median_Vector_S5_15cm(100:4900);
Vec_Cut_S5_20cm = Median_Vector_S5_20cm(100:4900);
Vec_Cut_S5_25cm = Median_Vector_S5_25cm(100:4900);
Vec_Cut_S5_30cm = Median_Vector_S5_30cm(100:4900);
Vec_Cut_S5_35cm = Median_Vector_S5_35cm(100:4900);


S1_Box_Data_Cut = [Vec_Cut_S1_0cm.' Vec_Cut_S1_10cm.' Vec_Cut_S1_15cm.' Vec_Cut_S1_20cm.' Vec_Cut_S1_25cm.' Vec_Cut_S1_30cm.' Vec_Cut_S1_35cm.'];
S2_Box_Data_Cut = [Vec_Cut_S2_0cm.' Vec_Cut_S2_10cm.' Vec_Cut_S2_15cm.' Vec_Cut_S2_20cm.' Vec_Cut_S2_25cm.' Vec_Cut_S2_30cm.' Vec_Cut_S2_35cm.'];
S3_Box_Data_Cut = [Vec_Cut_S3_0cm.' Vec_Cut_S3_10cm.' Vec_Cut_S3_15cm.' Vec_Cut_S3_20cm.' Vec_Cut_S3_25cm.' Vec_Cut_S3_30cm.' Vec_Cut_S3_35cm.'];
S4_Box_Data_Cut = [Vec_Cut_S4_0cm.' Vec_Cut_S4_10cm.' Vec_Cut_S4_15cm.' Vec_Cut_S4_20cm.' Vec_Cut_S4_25cm.' Vec_Cut_S4_30cm.' Vec_Cut_S4_35cm.'];
S5_Box_Data_Cut = [Vec_Cut_S5_0cm.' Vec_Cut_S5_10cm.' Vec_Cut_S5_15cm.' Vec_Cut_S5_20cm.' Vec_Cut_S5_25cm.' Vec_Cut_S5_30cm.' Vec_Cut_S5_35cm.'];

figure("Name",'Pressure with ref 1.1V Boxplot smaller');
tiledlayout(5,1,'TileSpacing','Compact','Padding','Compact');

nexttile
S1_B_Cut = boxplot(S1_Box_Data_Cut,'Notch','on','Labels',{'0cm','10cm','15cm','20cm','25cm','30cm','35cm'});
title("Pressure by depth S1")
xlabel("Depth [cm]:")
ylabel("Pressure [Kpa]:")

nexttile
S2_B_Cut = boxplot(S2_Box_Data_Cut,'Notch','on','Labels',{'0cm','10cm','15cm','20cm','25cm','30cm','35cm'});
title("Pressure by depth S2")
xlabel("Depth [cm]:")
ylabel("Pressure [Kpa]:")

nexttile
S3_B_Cut = boxplot(S3_Box_Data_Cut,'Notch','on','Labels',{'0cm','10cm','15cm','20cm','25cm','30cm','35cm'});
title("Pressure by depth S3")
xlabel("Depth [cm]:")
ylabel("Pressure [Kpa]:")

nexttile
S4_B_Cut = boxplot(S4_Box_Data_Cut,'Notch','on','Labels',{'0cm','10cm','15cm','20cm','25cm','30cm','35cm'});
title("Pressure by depth S4")
xlabel("Depth [cm]:")
ylabel("Pressure [Kpa]:")

nexttile
S5_B_Cut = boxplot(S5_Box_Data_Cut,'Notch','on','Labels',{'0cm','10cm','15cm','20cm','25cm','30cm','35cm'});
title("Pressure by depth S5")
xlabel("Depth [cm]:")
ylabel("Pressure [Kpa]:")